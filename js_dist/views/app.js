define(["backbone","jquery","underscore","js_dist/collections/todo","js_dist/views/todo"],function(e,t,o,n,l){var d='<span id="todo-count"><strong><%= undoneCount ? undoneCount : 0 %></strong> item left</span><button id="clear-completed" class="<%= doneCount == 0 ? "hidden" : "" %>">Clear completed</button>',i=e.View.extend({initialize:function(){this.todos=new n,this.listenTo(this.todos,"add",this.addTodoView),this.listenTo(this.todos,"all",this.render),this.$toggleAll=t("#toggle-all");var e=this.$toggleAll.find(".toggle").length;this.todos.fetch(),t("#toggle-all")[0].checked=this.$toggleAll.find(".toggle:checked").length===e&&0!==e?!0:!1,t("#new-todo").val("").focus()},el:"#todoapp",template:o.template(d),events:{"keypress #new-todo":"handleEnterText","change #toggle-all":"handleToggleAll","click #clear-completed":"clearDone"},render:function(){var e=this.todos.getUndone().length,o=this.todos.getDone().length;t("#footer").html(this.template({undoneCount:e,doneCount:o}))},clearDone:function(){o.invoke(this.todos.getDone(),"destroy")},handleEnterText:function(e){var o=t(e.currentTarget),n=o.val(),l=t.trim(n);13===e.which&&l&&(this.addTodo(l),o.val(""))},addTodo:function(e){this.todos.create({content:e})},addTodoView:function(e){var o=new l({model:e});t("#todo-list").prepend(o.render().$el)},handleToggleAll:function(e){var t=e.currentTarget.checked;this.toggleAll(t)},toggleAll:function(e){this.todos.each(function(t){t.save("done",e)})}});return i});